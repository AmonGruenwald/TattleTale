\hypertarget{kernel_8hpp_source}{}\doxysection{kernel.\+hpp}
\label{kernel_8hpp_source}\index{shared/kernels/kernel.hpp@{shared/kernels/kernel.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef TALE\_KERNEL\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define TALE\_KERNEL\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <fmt/core.h>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <fmt/format.h>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetattletale}{tattletale}}}
\DoxyCodeLine{11 \{}
\DoxyCodeLine{15     \textcolor{keyword}{enum class} \mbox{\hyperlink{namespacetattletale_a58dcf4c550c5f0a27c234f34489e6670}{KernelType}}}
\DoxyCodeLine{16     \{}
\DoxyCodeLine{17         kNone,}
\DoxyCodeLine{18         kResource,}
\DoxyCodeLine{19         kEmotion,}
\DoxyCodeLine{20         kRelationship,}
\DoxyCodeLine{21         kInteraction,}
\DoxyCodeLine{22         kGoal,}
\DoxyCodeLine{23         kLast}
\DoxyCodeLine{24     \};}
\DoxyCodeLine{25     \textcolor{keyword}{class }Actor;}
\DoxyCodeLine{35     \textcolor{keyword}{class }\mbox{\hyperlink{classtattletale_1_1_kernel}{Kernel}}}
\DoxyCodeLine{36     \{}
\DoxyCodeLine{37     \textcolor{keyword}{public}:}
\DoxyCodeLine{41         std::string \mbox{\hyperlink{classtattletale_1_1_kernel_a93b365fcda5e3698083beb777aff99f3}{name\_}};}
\DoxyCodeLine{45         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classtattletale_1_1_kernel_acdcd074e1cd7ad2b9b609b1c236ecb55}{id\_}};}
\DoxyCodeLine{49         \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classtattletale_1_1_kernel_afab1808227fd1d3db2908c8dc163b6eb}{tick\_}};}
\DoxyCodeLine{53         \mbox{\hyperlink{namespacetattletale_a58dcf4c550c5f0a27c234f34489e6670}{KernelType}} \mbox{\hyperlink{classtattletale_1_1_kernel_af6032d677e09bf99c41f180de38cc835}{type\_}};}
\DoxyCodeLine{57         \textcolor{keyword}{virtual} \mbox{\hyperlink{classtattletale_1_1_kernel_ae443c5ca39fc431ebdfc0c668b29c417}{\string~Kernel}}();}
\DoxyCodeLine{58 }
\DoxyCodeLine{64         \textcolor{keywordtype}{void} \mbox{\hyperlink{classtattletale_1_1_kernel_a3649e09f7bb2c8e5a6fa39dcbf667962}{AddConsequence}}(\mbox{\hyperlink{classtattletale_1_1_kernel}{Kernel}} *consequence);}
\DoxyCodeLine{70         \textcolor{keyword}{const} std::vector<Kernel *> \&\mbox{\hyperlink{classtattletale_1_1_kernel_a722c702ebf255e76ecb5292d41915ce6}{GetConsequences}}() \textcolor{keyword}{const};}
\DoxyCodeLine{76         \textcolor{keyword}{virtual} \textcolor{keyword}{const} std::vector<Kernel *> \&\mbox{\hyperlink{classtattletale_1_1_kernel_a147e8032c06bb3aca9ad998316e2ebcb}{GetReasons}}() \textcolor{keyword}{const};}
\DoxyCodeLine{84         \textcolor{keyword}{virtual} std::string \mbox{\hyperlink{classtattletale_1_1_kernel_a2df1d1bf2de3557317cdd91bcb8f1ce0}{GetDefaultDescription}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{93         \textcolor{keyword}{virtual} std::string \mbox{\hyperlink{classtattletale_1_1_kernel_a604ea09606e2530e03474fec80d80afd}{GetDetailedDescription}}() \textcolor{keyword}{const};}
\DoxyCodeLine{102         \textcolor{keyword}{virtual} std::string \mbox{\hyperlink{classtattletale_1_1_kernel_aaa1afd2ae2abff75a8376872e6642b0a}{GetPassiveDescription}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{111         \textcolor{keyword}{virtual} std::string \mbox{\hyperlink{classtattletale_1_1_kernel_a979570cb92c953513a210f10c748c777}{GetActiveDescription}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{117         \textcolor{keyword}{virtual} \textcolor{keywordtype}{float} \mbox{\hyperlink{classtattletale_1_1_kernel_a447036911c901aace53a699a11e34e07}{GetChance}}() \textcolor{keyword}{const};}
\DoxyCodeLine{123         \mbox{\hyperlink{classtattletale_1_1_actor}{Actor}} *\mbox{\hyperlink{classtattletale_1_1_kernel_a3dc8f98551c2ca59fa658dbc5ccb44c9}{GetOwner}}() \textcolor{keyword}{const};}
\DoxyCodeLine{124 }
\DoxyCodeLine{125     \textcolor{keyword}{protected}:}
\DoxyCodeLine{129         \mbox{\hyperlink{classtattletale_1_1_actor}{Actor}} *\mbox{\hyperlink{classtattletale_1_1_kernel_a66ab8f8a7b82c136c922b3f062224c09}{owner\_}};}
\DoxyCodeLine{133         std::vector<Kernel *> \mbox{\hyperlink{classtattletale_1_1_kernel_aeba9c27919b7917b14a711318e3d9cb3}{consequences\_}};}
\DoxyCodeLine{137         std::vector<Kernel *> \mbox{\hyperlink{classtattletale_1_1_kernel_a075e5bd7b7aec272786ae80f4ba223c7}{reasons\_}};}
\DoxyCodeLine{148         \mbox{\hyperlink{classtattletale_1_1_kernel_a6d0454571fa9ca4f238644a1d621a5ca}{Kernel}}(std::string name, \textcolor{keywordtype}{size\_t} \textcolor{keywordtype}{id}, \textcolor{keywordtype}{size\_t} tick, \mbox{\hyperlink{classtattletale_1_1_actor}{Actor}} *owner, std::vector<Kernel *> reasons, \mbox{\hyperlink{namespacetattletale_a58dcf4c550c5f0a27c234f34489e6670}{KernelType}} type);}
\DoxyCodeLine{149     \};}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \} \textcolor{comment}{// namespace tattletale}}
\DoxyCodeLine{152 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{153 \textcolor{keyword}{struct }fmt::formatter<T, std::enable\_if\_t<std::is\_base\_of<tattletale::Kernel, T>::value, char>> : fmt::formatter<std::string>}
\DoxyCodeLine{154 \{}
\DoxyCodeLine{155     \textcolor{comment}{// d -\/ default, a -\/ active, p -\/ passive, n -\/ name, o -\/ detailed}}
\DoxyCodeLine{156     \textcolor{keywordtype}{char} presentation = \textcolor{charliteral}{'d'};}
\DoxyCodeLine{157 }
\DoxyCodeLine{158     \textcolor{keyword}{constexpr} \textcolor{keyword}{auto} parse(format\_parse\_context \&ctx) -\/> \textcolor{keyword}{decltype}(ctx.begin())}
\DoxyCodeLine{159     \{}
\DoxyCodeLine{160         \textcolor{keyword}{auto} it = ctx.begin(), end = ctx.end();}
\DoxyCodeLine{161         \textcolor{keywordflow}{if} (it != end \&\& (*it == \textcolor{charliteral}{'a'} || *it == \textcolor{charliteral}{'p'} || *it == \textcolor{charliteral}{'n'} || *it == \textcolor{charliteral}{'d'} || *it == \textcolor{charliteral}{'o'}))}
\DoxyCodeLine{162             presentation = *it++;}
\DoxyCodeLine{163 }
\DoxyCodeLine{164         \textcolor{keywordflow}{if} (it != end \&\& *it != \textcolor{charliteral}{'\}'})}
\DoxyCodeLine{165             \textcolor{keywordflow}{throw} format\_error(\textcolor{stringliteral}{"{}invalid format"{}});}
\DoxyCodeLine{166 }
\DoxyCodeLine{167         \textcolor{keywordflow}{return} it;}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169 }
\DoxyCodeLine{170     \textcolor{keyword}{template} <\textcolor{keyword}{typename} FormatContext>}
\DoxyCodeLine{171     \textcolor{keyword}{auto} format(\mbox{\hyperlink{classtattletale_1_1_kernel}{tattletale::Kernel}} \&kernel, FormatContext \&ctx) -\/> \textcolor{keyword}{decltype}(ctx.out())}
\DoxyCodeLine{172     \{}
\DoxyCodeLine{173         \textcolor{keywordflow}{if} (presentation == \textcolor{charliteral}{'a'})}
\DoxyCodeLine{174         \{}
\DoxyCodeLine{175             \textcolor{keywordflow}{return} fmt::formatter<std::string>::format(kernel.\mbox{\hyperlink{classtattletale_1_1_kernel_a979570cb92c953513a210f10c748c777}{GetActiveDescription}}(), ctx);}
\DoxyCodeLine{176         \}}
\DoxyCodeLine{177         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (presentation == \textcolor{charliteral}{'p'})}
\DoxyCodeLine{178         \{}
\DoxyCodeLine{179             \textcolor{keywordflow}{return} fmt::formatter<std::string>::format(kernel.\mbox{\hyperlink{classtattletale_1_1_kernel_aaa1afd2ae2abff75a8376872e6642b0a}{GetPassiveDescription}}(), ctx);}
\DoxyCodeLine{180         \}}
\DoxyCodeLine{181         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (presentation == \textcolor{charliteral}{'n'})}
\DoxyCodeLine{182         \{}
\DoxyCodeLine{183             \textcolor{keywordflow}{return} fmt::formatter<std::string>::format(kernel.\mbox{\hyperlink{classtattletale_1_1_kernel_a93b365fcda5e3698083beb777aff99f3}{name\_}}, ctx);}
\DoxyCodeLine{184         \}}
\DoxyCodeLine{185         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (presentation == \textcolor{charliteral}{'o'})}
\DoxyCodeLine{186         \{}
\DoxyCodeLine{187             \textcolor{keywordflow}{return} fmt::formatter<std::string>::format(kernel.\mbox{\hyperlink{classtattletale_1_1_kernel_a604ea09606e2530e03474fec80d80afd}{GetDetailedDescription}}(), ctx);}
\DoxyCodeLine{188         \}}
\DoxyCodeLine{189         \textcolor{keywordflow}{return} fmt::formatter<std::string>::format(kernel.\mbox{\hyperlink{classtattletale_1_1_kernel_a2df1d1bf2de3557317cdd91bcb8f1ce0}{GetDefaultDescription}}(), ctx);}
\DoxyCodeLine{190     \}}
\DoxyCodeLine{191 \};}
\DoxyCodeLine{192 \textcolor{keyword}{template} <>}
\DoxyCodeLine{193 \textcolor{keyword}{struct }fmt::formatter<\mbox{\hyperlink{namespacetattletale}{tattletale}}::KernelType> : formatter<string\_view>}
\DoxyCodeLine{194 \{}
\DoxyCodeLine{195     std::string kernel\_type\_names[7] = \{}
\DoxyCodeLine{196         \textcolor{stringliteral}{"{}none"{}},}
\DoxyCodeLine{197         \textcolor{stringliteral}{"{}resource"{}},}
\DoxyCodeLine{198         \textcolor{stringliteral}{"{}emotion"{}},}
\DoxyCodeLine{199         \textcolor{stringliteral}{"{}relationship"{}},}
\DoxyCodeLine{200         \textcolor{stringliteral}{"{}interaction"{}},}
\DoxyCodeLine{201         \textcolor{stringliteral}{"{}goal"{}},}
\DoxyCodeLine{202         \textcolor{stringliteral}{"{}last"{}},}
\DoxyCodeLine{203     \};}
\DoxyCodeLine{204     \textcolor{comment}{// parse is inherited from formatter<string\_view>.}}
\DoxyCodeLine{205     \textcolor{keyword}{template} <\textcolor{keyword}{typename} FormatContext>}
\DoxyCodeLine{206     \textcolor{keyword}{auto} format(\mbox{\hyperlink{namespacetattletale_a58dcf4c550c5f0a27c234f34489e6670}{tattletale::KernelType}} type, FormatContext \&ctx)}
\DoxyCodeLine{207     \{}
\DoxyCodeLine{208         \textcolor{keywordtype}{size\_t} enum\_index = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(type);}
\DoxyCodeLine{209         string\_view name = kernel\_type\_names[enum\_index];}
\DoxyCodeLine{210         \textcolor{keywordflow}{return} formatter<string\_view>::format(name, ctx);}
\DoxyCodeLine{211     \}}
\DoxyCodeLine{212 \};}
\DoxyCodeLine{213 }
\DoxyCodeLine{214 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// TALE\_KERNEL\_H}}

\end{DoxyCode}
