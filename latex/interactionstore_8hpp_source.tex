\hypertarget{interactionstore_8hpp_source}{}\doxysection{interactionstore.\+hpp}
\label{interactionstore_8hpp_source}\index{tale/interactionstore.hpp@{tale/interactionstore.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef TALE\_GLOBALS\_INTERACTIONSTORE\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define TALE\_GLOBALS\_INTERACTIONSTORE\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}shared/kernels/interactions/interaction.hpp"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}shared/kernels/interactions/interactionprototype.hpp"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}shared/kernels/interactions/interactionrequirement.hpp"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}shared/kernels/interactions/interactiontendency.hpp"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}shared/random.hpp"{}}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}shared/chronicle.hpp"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}shared/tattletalecore.hpp"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <nlohmann/json.hpp>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <fmt/core.h>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <robin\_hood.h>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetattletale}{tattletale}}}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19     \textcolor{keyword}{class }Actor;}
\DoxyCodeLine{26     \textcolor{keyword}{class }\mbox{\hyperlink{classtattletale_1_1_interaction_store}{InteractionStore}}}
\DoxyCodeLine{27     \{}
\DoxyCodeLine{28     \textcolor{keyword}{public}:}
\DoxyCodeLine{36         \mbox{\hyperlink{classtattletale_1_1_interaction_store_aeaa067d5905a980839430dd3de1ec9c6}{InteractionStore}}(\mbox{\hyperlink{classtattletale_1_1_random}{Random}} \&random);}
\DoxyCodeLine{42         uint32\_t \mbox{\hyperlink{classtattletale_1_1_interaction_store_a8c0b5e13ffc6c3a5ef8357c13578053b}{GetRandomInteractionPrototypeIndex}}() \textcolor{keyword}{const};}
\DoxyCodeLine{49         std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_ab80b77cf49c734a48f9aaa8db76ae860}{GetInteractionName}}(\textcolor{keywordtype}{size\_t} prototype\_index) \textcolor{keyword}{const};}
\DoxyCodeLine{59         \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_af38872ad8f22f778a728ba03711fe837}{GetParticipantCount}}(\textcolor{keywordtype}{size\_t} prototype\_index) \textcolor{keyword}{const};}
\DoxyCodeLine{67         \textcolor{keyword}{const} std::vector<float> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_a287784e25d490eebd6ac5c47f6e8b154}{GetWealthEffects}}(\textcolor{keywordtype}{size\_t} prototype\_index) \textcolor{keyword}{const};}
\DoxyCodeLine{75         \textcolor{keyword}{const} std::vector<std::vector<float>> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_a46c31740c65f910de25ed73bd8383b73}{GetEmotionEffects}}(\textcolor{keywordtype}{size\_t} prototype\_index) \textcolor{keyword}{const};}
\DoxyCodeLine{83         \textcolor{keyword}{const} std::vector<robin\_hood::unordered\_map<size\_t, std::vector<float>>> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_adb8f2d017282a087fc0d81be73a17848}{GetRelationshipEffects}}(\textcolor{keywordtype}{size\_t} prototype\_index) \textcolor{keyword}{const};}
\DoxyCodeLine{95         \mbox{\hyperlink{classtattletale_1_1_interaction}{Interaction}} *\mbox{\hyperlink{classtattletale_1_1_interaction_store_a9d0eed36f3a2e345183fd3b94b1a8746}{CreateInteraction}}(\mbox{\hyperlink{classtattletale_1_1_chronicle}{Chronicle}} \&chronicle, \textcolor{keywordtype}{size\_t} prototype\_index, \textcolor{keywordtype}{float} chance, \textcolor{keywordtype}{size\_t} tick, std::vector<Kernel *> reasons, std::vector<Actor *> participants);}
\DoxyCodeLine{101         \textcolor{keyword}{const} std::vector<std::shared\_ptr<InteractionRequirement>> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_aabfe52632f5d17b4e8377dd72b8de97a}{GetRequirementCatalogue}}() \textcolor{keyword}{const};}
\DoxyCodeLine{107         \textcolor{keyword}{const} std::vector<std::shared\_ptr<InteractionTendency>> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_acc72f0516ce3cfeddcc21405b5690568}{GetTendencyCatalogue}}() \textcolor{keyword}{const};}
\DoxyCodeLine{113         \textcolor{keyword}{const} std::vector<std::shared\_ptr<InteractionPrototype>> \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_a82d0eef5185efab17613a217ebeb1a68}{GetPrototypeCatalogue}}() \textcolor{keyword}{const};}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{keyword}{private}:}
\DoxyCodeLine{119         \mbox{\hyperlink{classtattletale_1_1_random}{Random}} \&\mbox{\hyperlink{classtattletale_1_1_interaction_store_afaf80047ea82c970efd77483dc8332cd}{random\_}};}
\DoxyCodeLine{123         std::vector<std::shared\_ptr<InteractionPrototype>> \mbox{\hyperlink{classtattletale_1_1_interaction_store_a2520885627e6cd592892308e75ca5fac}{prototype\_catalogue\_}};}
\DoxyCodeLine{127         std::vector<std::shared\_ptr<InteractionRequirement>> \mbox{\hyperlink{classtattletale_1_1_interaction_store_a561790a4e437ba03f18b3a8f52908e02}{requirements\_catalogue\_}};}
\DoxyCodeLine{131         std::vector<std::shared\_ptr<InteractionTendency>> \mbox{\hyperlink{classtattletale_1_1_interaction_store_a4652da789f7c702d0216817549aed1e1}{tendencies\_catalogue\_}};}
\DoxyCodeLine{135         std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a21c7054e51fe503ff715c0dff3397f21}{prototype\_json\_path\_}} = \textcolor{stringliteral}{"{}resources/interactioncatalogue.json"{}};}
\DoxyCodeLine{136 }
\DoxyCodeLine{140         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_af3edc2bdf23eea7637e7e3c21abefcd6}{requirements\_key\_}} = \textcolor{stringliteral}{"{}requirements"{}};}
\DoxyCodeLine{144         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a0204103c5945e69c7ceaa0413577dc04}{name\_key\_}} = \textcolor{stringliteral}{"{}name"{}};}
\DoxyCodeLine{148         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a3e6abcf1a0d578cc2f8765d86dcb0f9f}{absolute\_interest\_key\_}} = \textcolor{stringliteral}{"{}absolute\_interest"{}};}
\DoxyCodeLine{152         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_aadeea103eeef6d2ecc930f99b0b6f92a}{fluff\_key\_}} = \textcolor{stringliteral}{"{}fluff"{}};}
\DoxyCodeLine{156         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a22f5acd1301b570bb88dccd885d79a9b}{angst\_key\_}} = \textcolor{stringliteral}{"{}angst"{}};}
\DoxyCodeLine{160         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_ab7a96c9edb9e1fa90a2587d1438fd83b}{sexual\_key\_}} = \textcolor{stringliteral}{"{}sexual"{}};}
\DoxyCodeLine{164         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a4e184907932f24d766cacb127693b0fe}{description\_key\_}} = \textcolor{stringliteral}{"{}description"{}};}
\DoxyCodeLine{168         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_ad39606314481ddb69b12a1890563f975}{passive\_description\_key\_}} = \textcolor{stringliteral}{"{}passive\_description"{}};}
\DoxyCodeLine{172         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_ab8d5a95657441d203cd0c20e634226b1}{active\_description\_key\_}} = \textcolor{stringliteral}{"{}active\_description"{}};}
\DoxyCodeLine{176         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_ab4cfd6a685470d93473972fbd181401c}{participant\_count\_key\_}} = \textcolor{stringliteral}{"{}participant\_count"{}};}
\DoxyCodeLine{180         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a332379d01ca9f4208ff43808a76653a2}{goal\_type\_key\_}} = \textcolor{stringliteral}{"{}goal\_type"{}};}
\DoxyCodeLine{184         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_abd2752cc798af7efe46274978ff9d366}{day\_key\_}} = \textcolor{stringliteral}{"{}day"{}};}
\DoxyCodeLine{188         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a6840aa1f8b8fdc4bb31e668e0d8c9466}{wealth\_key\_}} = \textcolor{stringliteral}{"{}wealth"{}};}
\DoxyCodeLine{192         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a51aa9d27cfa3f4570d1cf5c64afc5bc1}{emotion\_key\_}} = \textcolor{stringliteral}{"{}emotions"{}};}
\DoxyCodeLine{196         \textcolor{keyword}{const} std::vector<std::string> \mbox{\hyperlink{classtattletale_1_1_interaction_store_ad641a4b7da5a45b3a5f8be274acb9804}{emotion\_type\_keys\_}} = \{\textcolor{stringliteral}{"{}happy"{}}, \textcolor{stringliteral}{"{}calm"{}}, \textcolor{stringliteral}{"{}satisfied"{}}, \textcolor{stringliteral}{"{}brave"{}}, \textcolor{stringliteral}{"{}extroverted"{}}\};}
\DoxyCodeLine{200         \textcolor{keyword}{const} std::vector<std::string> \mbox{\hyperlink{classtattletale_1_1_interaction_store_ad4a367b3b21634c59604f238a79e9da0}{context\_type\_keys\_}} = \{\textcolor{stringliteral}{"{}course"{}}, \textcolor{stringliteral}{"{}freetime"{}}\};}
\DoxyCodeLine{204         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a12621958aec11f328a25dad858241b59}{relationships\_key\_}} = \textcolor{stringliteral}{"{}relationships"{}};}
\DoxyCodeLine{208         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a9c94bff866109999e0ba92049ad4b021}{participant\_key\_}} = \textcolor{stringliteral}{"{}participant"{}};}
\DoxyCodeLine{212         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a74bc1491020a97ac7d431a69deeb4e4e}{changes\_key\_}} = \textcolor{stringliteral}{"{}changes"{}};}
\DoxyCodeLine{216         \textcolor{keyword}{const} std::vector<std::string> \mbox{\hyperlink{classtattletale_1_1_interaction_store_a739c1460ee928da14c373d14e2c0aa54}{relationship\_type\_keys\_}} = \{\textcolor{stringliteral}{"{}love"{}}, \textcolor{stringliteral}{"{}attraction"{}}, \textcolor{stringliteral}{"{}friendship"{}}, \textcolor{stringliteral}{"{}anger"{}}, \textcolor{stringliteral}{"{}protective"{}}\};}
\DoxyCodeLine{220         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a13d1c3cb7606a3496744e9113d65dfec}{context\_key\_}} = \textcolor{stringliteral}{"{}context"{}};}
\DoxyCodeLine{224         \textcolor{keyword}{const} std::string \mbox{\hyperlink{classtattletale_1_1_interaction_store_a95f350ea8232ab72f6ea85aa7251f968}{group\_size\_key\_}} = \textcolor{stringliteral}{"{}group\_size"{}};}
\DoxyCodeLine{225 }
\DoxyCodeLine{237         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_a868562000417860588bedfdb2b22db89}{ReadPrototypeJSON}}(nlohmann::json json, \textcolor{keywordtype}{size\_t} participant\_count, std::string error\_preamble, std::shared\_ptr<InteractionPrototype> \&out\_prototype);}
\DoxyCodeLine{248         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_a09016762be6c47c11317915ba3c796d9}{ReadRequirementJSON}}(nlohmann::json json, std::string error\_preamble, std::shared\_ptr<InteractionRequirement> \&out\_requirement);}
\DoxyCodeLine{260         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_abe863348c479675da2b3a8c5434687bb}{ReadTendencyJSON}}(nlohmann::json json, \textcolor{keywordtype}{size\_t} participant\_count, std::string error\_preamble, std::shared\_ptr<InteractionTendency> \&out\_tendency);}
\DoxyCodeLine{261 }
\DoxyCodeLine{274         \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, nlohmann::detail::value\_t T2>}
\DoxyCodeLine{275         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_af8b5333709830ab22fc3bea40a6c5ff5}{ReadJsonValueFromDictionary}}(T1 \&out\_value, nlohmann::json json, std::string key, \textcolor{keywordtype}{bool} required, std::string error\_preamble = \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{276         \{}
\DoxyCodeLine{277             \textcolor{keywordflow}{if} (!json.contains(key))}
\DoxyCodeLine{278             \{}
\DoxyCodeLine{279                 \textcolor{keywordflow}{if} (required)}
\DoxyCodeLine{280                 \{}
\DoxyCodeLine{281                     TATTLETALE\_ERROR\_PRINT(\textcolor{keyword}{true}, fmt::format(\textcolor{stringliteral}{"{}\{\}JSON DID NOT CONTAIN KEY \{\}"{}}, error\_preamble, key));}
\DoxyCodeLine{282                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{283                 \}}
\DoxyCodeLine{284             \}}
\DoxyCodeLine{285             \textcolor{keywordflow}{else}}
\DoxyCodeLine{286             \{}
\DoxyCodeLine{287                 \textcolor{keywordflow}{if} (json[key].type() == T2)}
\DoxyCodeLine{288                 \{}
\DoxyCodeLine{289                     out\_value = json[key];}
\DoxyCodeLine{290                 \}}
\DoxyCodeLine{291                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{292                 \{}
\DoxyCodeLine{293                     TATTLETALE\_ERROR\_PRINT(\textcolor{keyword}{true}, fmt::format(\textcolor{stringliteral}{"{}\{\}VALUE FOR KEY \{\} WAS OF AN INCORRECT TYPE"{}}, error\_preamble, key));}
\DoxyCodeLine{294                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{295                 \}}
\DoxyCodeLine{296             \}}
\DoxyCodeLine{297             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{298         \}}
\DoxyCodeLine{299 }
\DoxyCodeLine{312         \textcolor{keyword}{template} <\textcolor{keyword}{typename} T1, nlohmann::detail::value\_t T2>}
\DoxyCodeLine{313         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_af9e0dba1342f0d868431ab786836dca6}{ReadJsonValueFromArray}}(T1 \&out\_value, nlohmann::json json, \textcolor{keywordtype}{size\_t} index, \textcolor{keywordtype}{bool} required, std::string error\_preamble = \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{314         \{}
\DoxyCodeLine{315             \textcolor{keywordflow}{if} (json.size() <= index)}
\DoxyCodeLine{316             \{}
\DoxyCodeLine{317                 \textcolor{keywordflow}{if} (required)}
\DoxyCodeLine{318                 \{}
\DoxyCodeLine{319                     TATTLETALE\_ERROR\_PRINT(\textcolor{keyword}{true}, fmt::format(\textcolor{stringliteral}{"{}\{\}JSON DID NOT CONTAIN INDEX \{\}"{}}, error\_preamble, index));}
\DoxyCodeLine{320                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{321                 \}}
\DoxyCodeLine{322             \}}
\DoxyCodeLine{323             \textcolor{keywordflow}{else}}
\DoxyCodeLine{324             \{}
\DoxyCodeLine{325                 \textcolor{keywordflow}{if} (json[index].type() == T2)}
\DoxyCodeLine{326                 \{}
\DoxyCodeLine{327                     out\_value = json[index];}
\DoxyCodeLine{328                 \}}
\DoxyCodeLine{329                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{330                 \{}
\DoxyCodeLine{331                     TATTLETALE\_ERROR\_PRINT(\textcolor{keyword}{true}, fmt::format(\textcolor{stringliteral}{"{}\{\}VALUE FOR INDEX \{\} WAS OF AN INCORRECT TYPE"{}}, error\_preamble, index));}
\DoxyCodeLine{332                     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{333                 \}}
\DoxyCodeLine{334             \}}
\DoxyCodeLine{335             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{336         \}}
\DoxyCodeLine{337 }
\DoxyCodeLine{345         \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtattletale_1_1_interaction_store_a3c6cf29ce0964b77acfa9ed3f8996a27}{CheckCorrectValueRange}}(\textcolor{keywordtype}{float} value, std::string error\_preamble = \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{346     \};}
\DoxyCodeLine{347 }
\DoxyCodeLine{348 \} \textcolor{comment}{// namespace tattletale}}
\DoxyCodeLine{349 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// TALE\_GLOBALS\_INTERACTIONSTORE\_H}}

\end{DoxyCode}
